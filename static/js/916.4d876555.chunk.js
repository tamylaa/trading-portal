"use strict";(self.webpackChunktrading_portal=self.webpackChunktrading_portal||[]).push([[916],{3916:(e,a,t)=>{t.r(a),t.d(a,{EnhancedEmailBlaster:()=>O});var s=t(9379),n=t(3986),l=t(5043);const i="EmailComposer_emailComposer__N+o9O",c="EmailComposer_header__Fs5Ph",o="EmailComposer_title__8Eqtq",m="EmailComposer_subtitle__ERU2e",d="EmailComposer_formSection__qz2vn",r="EmailComposer_sectionTitle__oewLQ",h="EmailComposer_recipientInput__vnDz9",p="EmailComposer_recipientTags__8Kvq4",_="EmailComposer_recipientTag__SH7bg",u="EmailComposer_tagRemove__qpCG4",E="EmailComposer_contentSection__-AJ3l",j="EmailComposer_subjectInput__Zi0ty",x="EmailComposer_contentEditor__AfZPF",C="EmailComposer_contentTextarea__cXpzG",b="EmailComposer_actions__sNJ2o",N="EmailComposer_actionGroup__1JZi6",v="EmailComposer_sendButton__JQuNj",g="EmailComposer_loading__tWQgp",B="EmailComposer_loadingSpinner__yJISH";var S=t(579);const y=["onSend","initialContent","className","data-testid"],k=e=>{let{onSend:a,initialContent:t="",className:k="","data-testid":A="email-composer"}=e,f=(0,n.A)(e,y);const[w,T]=(0,l.useState)(""),[q,F]=(0,l.useState)(t),[J,z]=(0,l.useState)([]),[H,U]=(0,l.useState)(!1),D=(0,l.useCallback)(async()=>{if(w.trim()&&q.trim()){U(!0);try{await(null===a||void 0===a?void 0:a({subject:w.trim(),content:q.trim(),attachments:J,timestamp:(new Date).toISOString()}))}catch(e){console.error("Failed to send email:",e)}finally{U(!1)}}},[w,q,J,a]),G=(0,l.useCallback)(e=>{const a=e.target.files;a&&z(e=>[...e,...Array.from(a)])},[]),I=(0,l.useCallback)(e=>{z(a=>a.filter((a,t)=>t!==e))},[]),L=w.trim()&&q.trim();return(0,S.jsxs)("div",(0,s.A)((0,s.A)({className:"".concat(i," ").concat(k),"data-testid":A},f),{},{children:[(0,S.jsxs)("div",{className:c,children:[(0,S.jsx)("h3",{className:o,children:"Compose Email"}),(0,S.jsx)("p",{className:m,children:"Create and send personalized emails"})]}),(0,S.jsxs)("div",{className:d,children:[(0,S.jsx)("label",{htmlFor:"email-subject",className:r,children:"Subject *"}),(0,S.jsx)("input",{id:"email-subject",type:"text",placeholder:"Enter email subject",value:w,onChange:e=>T(e.target.value),className:j,"data-testid":"email-subject-input"})]}),(0,S.jsxs)("div",{className:E,children:[(0,S.jsx)("h4",{className:r,children:"Email Content *"}),(0,S.jsx)("div",{className:x,children:(0,S.jsx)("textarea",{id:"email-content",placeholder:"Enter your email content...",value:q,onChange:e=>F(e.target.value),className:C,rows:12,"data-testid":"email-content-textarea"})})]}),(0,S.jsxs)("div",{className:d,children:[(0,S.jsx)("label",{htmlFor:"email-attachments",className:r,children:"Attachments"}),(0,S.jsx)("input",{id:"email-attachments",type:"file",multiple:!0,onChange:G,className:h,"data-testid":"email-attachments-input"}),J.length>0&&(0,S.jsx)("div",{className:p,children:J.map((e,a)=>(0,S.jsxs)("div",{className:_,children:[(0,S.jsx)("span",{children:e.name}),(0,S.jsx)("button",{type:"button",onClick:()=>I(a),className:u,"aria-label":"Remove ".concat(e.name),children:"\xd7"})]},"".concat(e.name,"-").concat(a)))})]}),(0,S.jsxs)("div",{className:b,children:[(0,S.jsx)("div",{className:N,children:(0,S.jsxs)("span",{className:m,children:[q.length," characters",J.length>0&&" \u2022 ".concat(J.length," attachment").concat(1!==J.length?"s":"")]})}),(0,S.jsx)("div",{className:N,children:(0,S.jsxs)("button",{type:"button",onClick:D,disabled:!L||H,className:H?g:v,"data-testid":"send-email-button",children:[H&&(0,S.jsx)("span",{className:B}),H?"Sending...":"Send Email"]})})]})]}))},A="EnhancedEmailBlaster_container__xibF4",f="EnhancedEmailBlaster_header__jHzYs",w="EnhancedEmailBlaster_headerContent__7qv35",T="EnhancedEmailBlaster_title__9HiJA",q="EnhancedEmailBlaster_subtitle__JUN3T",F="EnhancedEmailBlaster_closeButton__aVlFv",J="EnhancedEmailBlaster_tabs__BtqGA",z="EnhancedEmailBlaster_tab__e0cnX",H="EnhancedEmailBlaster_tabActive__WJKUL",U="EnhancedEmailBlaster_content__5luU6",D="EnhancedEmailBlaster_placeholder__tL8yX",G="EnhancedEmailBlaster_loadingOverlay__LBY3q",I="EnhancedEmailBlaster_loadingSpinner__869se",L="EnhancedEmailBlaster_spinner__foTHp",X=["onClose","onSuccess","onError","mode","initialData","className","data-testid"],O=e=>{let{onClose:a,onSuccess:i,onError:c,mode:o="compose",initialData:m,className:d="","data-testid":r="enhanced-email-blaster"}=e,h=(0,n.A)(e,X);const[p,_]=(0,l.useState)(o),[u,E]=(0,l.useState)(!1),j=(0,l.useCallback)(async e=>{E(!0);try{const{emailApi:a}=t(1883),s=await a.sendEmail({subject:e.subject,message:e.content,attachments:e.attachments||[],timestamp:e.timestamp});s.success?null===i||void 0===i||i(s):null===c||void 0===c||c(new Error(s.error||"Failed to send email"))}catch(a){console.error("Enhanced EmailBlaster send error:",a),null===c||void 0===c||c(a)}finally{E(!1)}},[i,c]),x=(0,l.useCallback)(()=>{u||null===a||void 0===a||a()},[a,u]);return(0,S.jsxs)("div",(0,s.A)((0,s.A)({className:"".concat(A," ").concat(d),"data-testid":r},h),{},{children:[(0,S.jsxs)("div",{className:f,children:[(0,S.jsxs)("div",{className:w,children:[(0,S.jsx)("h2",{className:T,children:"Email Campaign"}),(0,S.jsx)("p",{className:q,children:"Enhanced email composition with better UX"})]}),(0,S.jsx)("button",{onClick:x,disabled:u,className:F,"aria-label":"Close email composer","data-testid":"close-email-blaster",children:"\xd7"})]}),(0,S.jsxs)("div",{className:J,children:[(0,S.jsx)("button",{className:"".concat(z," ").concat("compose"===p?H:""),onClick:()=>_("compose"),disabled:u,"data-testid":"compose-tab",children:"Compose"}),(0,S.jsx)("button",{className:"".concat(z," ").concat("templates"===p?H:""),onClick:()=>_("templates"),disabled:u,"data-testid":"templates-tab",children:"Templates"}),(0,S.jsx)("button",{className:"".concat(z," ").concat("campaigns"===p?H:""),onClick:()=>_("campaigns"),disabled:u,"data-testid":"campaigns-tab",children:"Campaigns"}),(0,S.jsx)("button",{className:"".concat(z," ").concat("contacts"===p?H:""),onClick:()=>_("contacts"),disabled:u,"data-testid":"contacts-tab",children:"Contacts"})]}),(0,S.jsxs)("div",{className:U,children:["compose"===p&&(0,S.jsx)(k,{onSend:j,initialContent:(null===m||void 0===m?void 0:m.content)||"","data-testid":"email-composer-content"}),"templates"===p&&(0,S.jsxs)("div",{className:D,"data-testid":"templates-content",children:[(0,S.jsx)("h3",{children:"Email Templates"}),(0,S.jsx)("p",{children:"Template management will be implemented in the next iteration."}),(0,S.jsx)("p",{children:"This maintains the same tab structure as the original EmailBlaster."})]}),"campaigns"===p&&(0,S.jsxs)("div",{className:D,"data-testid":"campaigns-content",children:[(0,S.jsx)("h3",{children:"Campaign Management"}),(0,S.jsx)("p",{children:"Campaign features will be implemented in the next iteration."}),(0,S.jsx)("p",{children:"All existing campaign functionality is preserved in the original EmailBlaster."})]}),"contacts"===p&&(0,S.jsxs)("div",{className:D,"data-testid":"contacts-content",children:[(0,S.jsx)("h3",{children:"Contact Management"}),(0,S.jsx)("p",{children:"Contact management will be implemented in the next iteration."}),(0,S.jsx)("p",{children:"All existing contact functionality is preserved in the original EmailBlaster."})]})]}),u&&(0,S.jsx)("div",{className:G,"data-testid":"loading-overlay",children:(0,S.jsxs)("div",{className:I,children:[(0,S.jsx)("div",{className:L}),(0,S.jsx)("p",{children:"Sending email..."})]})})]}))}}}]);