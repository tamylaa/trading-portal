"use strict";(self.webpackChunktrading_portal=self.webpackChunktrading_portal||[]).push([[916],{3916:(e,a,t)=>{t.r(a),t.d(a,{EnhancedEmailBlaster:()=>U});var s=t(9379),n=t(3986),l=t(5043);const i="EmailComposer_emailComposer__+seFW",c="EmailComposer_header__-pvST",o="EmailComposer_title__d6hhj",m="EmailComposer_subtitle__XH2RH",d="EmailComposer_formSection__qddvx",r="EmailComposer_sectionTitle__TXI0p",h="EmailComposer_recipientInput__aqzZY",p="EmailComposer_recipientTags__XmHKy",_="EmailComposer_recipientTag__vU9bR",u="EmailComposer_tagRemove__tFOOK",j="EmailComposer_contentSection__fX5Bb",E="EmailComposer_subjectInput__vL8jK",x="EmailComposer_contentEditor__h4pJf",b="EmailComposer_contentTextarea__N1jNb",C="EmailComposer_actions__9D+4s",N="EmailComposer_actionGroup__wU8TN",v="EmailComposer_sendButton__oXcoZ",g="EmailComposer_loading__N8aQN",B="EmailComposer_loadingSpinner__9NaOn";var S=t(579);const k=["onSend","initialContent","className","data-testid"],y=e=>{let{onSend:a,initialContent:t="",className:y="","data-testid":f="email-composer"}=e,w=(0,n.A)(e,k);const[A,T]=(0,l.useState)(""),[F,R]=(0,l.useState)(t),[X,D]=(0,l.useState)([]),[I,K]=(0,l.useState)(!1),O=(0,l.useCallback)(async()=>{if(A.trim()&&F.trim()){K(!0);try{await(null===a||void 0===a?void 0:a({subject:A.trim(),content:F.trim(),attachments:X,timestamp:(new Date).toISOString()}))}catch(e){console.error("Failed to send email:",e)}finally{K(!1)}}},[A,F,X,a]),q=(0,l.useCallback)(e=>{const a=e.target.files;a&&D(e=>[...e,...Array.from(a)])},[]),H=(0,l.useCallback)(e=>{D(a=>a.filter((a,t)=>t!==e))},[]),M=A.trim()&&F.trim();return(0,S.jsxs)("div",(0,s.A)((0,s.A)({className:"".concat(i," ").concat(y),"data-testid":f},w),{},{children:[(0,S.jsxs)("div",{className:c,children:[(0,S.jsx)("h3",{className:o,children:"Compose Email"}),(0,S.jsx)("p",{className:m,children:"Create and send personalized emails"})]}),(0,S.jsxs)("div",{className:d,children:[(0,S.jsx)("label",{htmlFor:"email-subject",className:r,children:"Subject *"}),(0,S.jsx)("input",{id:"email-subject",type:"text",placeholder:"Enter email subject",value:A,onChange:e=>T(e.target.value),className:E,"data-testid":"email-subject-input"})]}),(0,S.jsxs)("div",{className:j,children:[(0,S.jsx)("h4",{className:r,children:"Email Content *"}),(0,S.jsx)("div",{className:x,children:(0,S.jsx)("textarea",{id:"email-content",placeholder:"Enter your email content...",value:F,onChange:e=>R(e.target.value),className:b,rows:12,"data-testid":"email-content-textarea"})})]}),(0,S.jsxs)("div",{className:d,children:[(0,S.jsx)("label",{htmlFor:"email-attachments",className:r,children:"Attachments"}),(0,S.jsx)("input",{id:"email-attachments",type:"file",multiple:!0,onChange:q,className:h,"data-testid":"email-attachments-input"}),X.length>0&&(0,S.jsx)("div",{className:p,children:X.map((e,a)=>(0,S.jsxs)("div",{className:_,children:[(0,S.jsx)("span",{children:e.name}),(0,S.jsx)("button",{type:"button",onClick:()=>H(a),className:u,"aria-label":"Remove ".concat(e.name),children:"\xd7"})]},"".concat(e.name,"-").concat(a)))})]}),(0,S.jsxs)("div",{className:C,children:[(0,S.jsx)("div",{className:N,children:(0,S.jsxs)("span",{className:m,children:[F.length," characters",X.length>0&&" \u2022 ".concat(X.length," attachment").concat(1!==X.length?"s":"")]})}),(0,S.jsx)("div",{className:N,children:(0,S.jsxs)("button",{type:"button",onClick:O,disabled:!M||I,className:I?g:v,"data-testid":"send-email-button",children:[I&&(0,S.jsx)("span",{className:B}),I?"Sending...":"Send Email"]})})]})]}))},f="EnhancedEmailBlaster_container__1j0Et",w="EnhancedEmailBlaster_header__+nKM6",A="EnhancedEmailBlaster_headerContent__dLpV8",T="EnhancedEmailBlaster_title__rhw-R",F="EnhancedEmailBlaster_subtitle__GM-pe",R="EnhancedEmailBlaster_closeButton__6jp78",X="EnhancedEmailBlaster_tabs__8RDdh",D="EnhancedEmailBlaster_tab__kVQkL",I="EnhancedEmailBlaster_tabActive__kuHBh",K="EnhancedEmailBlaster_content__-V7AK",O="EnhancedEmailBlaster_placeholder__jpYFF",q="EnhancedEmailBlaster_loadingOverlay__-1B+1",H="EnhancedEmailBlaster_loadingSpinner__175qZ",M="EnhancedEmailBlaster_spinner__0qnuI",L=["onClose","onSuccess","onError","mode","initialData","className","data-testid"],U=e=>{let{onClose:a,onSuccess:i,onError:c,mode:o="compose",initialData:m,className:d="","data-testid":r="enhanced-email-blaster"}=e,h=(0,n.A)(e,L);const[p,_]=(0,l.useState)(o),[u,j]=(0,l.useState)(!1),E=(0,l.useCallback)(async e=>{j(!0);try{const{emailApi:a}=t(1883),s=await a.sendEmail({subject:e.subject,message:e.content,attachments:e.attachments||[],timestamp:e.timestamp});s.success?null===i||void 0===i||i(s):null===c||void 0===c||c(new Error(s.error||"Failed to send email"))}catch(a){console.error("Enhanced EmailBlaster send error:",a),null===c||void 0===c||c(a)}finally{j(!1)}},[i,c]),x=(0,l.useCallback)(()=>{u||null===a||void 0===a||a()},[a,u]);return(0,S.jsxs)("div",(0,s.A)((0,s.A)({className:"".concat(f," ").concat(d),"data-testid":r},h),{},{children:[(0,S.jsxs)("div",{className:w,children:[(0,S.jsxs)("div",{className:A,children:[(0,S.jsx)("h2",{className:T,children:"Email Campaign"}),(0,S.jsx)("p",{className:F,children:"Enhanced email composition with better UX"})]}),(0,S.jsx)("button",{onClick:x,disabled:u,className:R,"aria-label":"Close email composer","data-testid":"close-email-blaster",children:"\xd7"})]}),(0,S.jsxs)("div",{className:X,children:[(0,S.jsx)("button",{className:"".concat(D," ").concat("compose"===p?I:""),onClick:()=>_("compose"),disabled:u,"data-testid":"compose-tab",children:"Compose"}),(0,S.jsx)("button",{className:"".concat(D," ").concat("templates"===p?I:""),onClick:()=>_("templates"),disabled:u,"data-testid":"templates-tab",children:"Templates"}),(0,S.jsx)("button",{className:"".concat(D," ").concat("campaigns"===p?I:""),onClick:()=>_("campaigns"),disabled:u,"data-testid":"campaigns-tab",children:"Campaigns"}),(0,S.jsx)("button",{className:"".concat(D," ").concat("contacts"===p?I:""),onClick:()=>_("contacts"),disabled:u,"data-testid":"contacts-tab",children:"Contacts"})]}),(0,S.jsxs)("div",{className:K,children:["compose"===p&&(0,S.jsx)(y,{onSend:E,initialContent:(null===m||void 0===m?void 0:m.content)||"","data-testid":"email-composer-content"}),"templates"===p&&(0,S.jsxs)("div",{className:O,"data-testid":"templates-content",children:[(0,S.jsx)("h3",{children:"Email Templates"}),(0,S.jsx)("p",{children:"Template management will be implemented in the next iteration."}),(0,S.jsx)("p",{children:"This maintains the same tab structure as the original EmailBlaster."})]}),"campaigns"===p&&(0,S.jsxs)("div",{className:O,"data-testid":"campaigns-content",children:[(0,S.jsx)("h3",{children:"Campaign Management"}),(0,S.jsx)("p",{children:"Campaign features will be implemented in the next iteration."}),(0,S.jsx)("p",{children:"All existing campaign functionality is preserved in the original EmailBlaster."})]}),"contacts"===p&&(0,S.jsxs)("div",{className:O,"data-testid":"contacts-content",children:[(0,S.jsx)("h3",{children:"Contact Management"}),(0,S.jsx)("p",{children:"Contact management will be implemented in the next iteration."}),(0,S.jsx)("p",{children:"All existing contact functionality is preserved in the original EmailBlaster."})]})]}),u&&(0,S.jsx)("div",{className:q,"data-testid":"loading-overlay",children:(0,S.jsxs)("div",{className:H,children:[(0,S.jsx)("div",{className:M}),(0,S.jsx)("p",{children:"Sending email..."})]})})]}))}}}]);